import os, re
import pandas as pd
from openpyxl import load_workbook
from openpyxl.styles import Font, Alignment, PatternFill
from openpyxl.cell import Cell
import copy
from datetime import datetime
import xlwings as xw

# –ü—É—Ç—å –∫ –ø–∞–ø–∫–µ —Å –∏—Å—Ö–æ–¥–Ω–∏–∫–∞–º–∏ .csv
folder_path_csv = r"\\10.8.0.52\mail\–Æ–ñ–ù–´–ô –ö–£–ó–ë–ê–°–°\NekhoroshevAN"

# –ü—É—Ç—å –∫ –ø–∞–ø–∫–µ –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞
folder_path_sprav = r"\\10.8.0.50\Prog\Sprav\Telefon\–¢–µ–ª–µ—Ñ–æ–Ω–Ω—ã–π —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –Æ–ö"
# folder_path_sprav = r"C:\Users\NekhoroshevAN\Documents\SpravUK"

# –ü—É—Ç—å –∫ —Ü–µ–ª–µ–≤–æ–º—É —Ñ–∞–π–ª—É —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞
target_file_path = "P:/Sprav/Telefon/–¢–µ–ª–µ—Ñ–æ–Ω–Ω—ã–π —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –Æ–ö/–ü–ê–û –Æ–∂–Ω—ã–π –ö—É–∑–±–∞—Å—Å.xlsx"
# target_file_path = "C:/Users/NekhoroshevAN/Documents/SpravUK/–ü–ê–û –Æ–∂–Ω—ã–π –ö—É–∑–±–∞—Å—Å.xlsx"

# –ü—É—Ç—å –∫ —Ñ–∞–π–ª—É —Å –¥–æ–ø–æ–ª–Ω–µ–Ω–∏—è–º–∏
add_file_path = "P:/Group/OIS/–û—Ç–¥–µ–ª –¢–ö/–ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞ –Æ–ö/–î–æ–ø–æ–ª–Ω–µ–Ω–∏—è.xlsx"

# –ü—É—Ç—å –∫ —Ñ–∞–π–ª—É –ª–æ–≥–∞
log_file_path = "P:/Group/OIS/–û—Ç–¥–µ–ª –¢–ö/–ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞ –Æ–ö/logfile.txt"

# –ü–æ–ª—É—á–∞–µ–º —Å–ø–∏—Å–æ–∫ —Ñ–∞–π–ª–æ–≤ .csv –≤ –ø–∞–ø–∫–µ
files = [file for file in os.listdir(folder_path_csv) if file.endswith('.csv')]

# –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ñ–∞–π–ª —Å –ø–æ—Å–ª–µ–¥–Ω–µ–π –¥–∞—Ç–æ–π –∏–∑–º–µ–Ω–µ–Ω–∏—è
latest_file = max(files, key=lambda f: os.path.getmtime(os.path.join(folder_path_csv, f)))

# –ü–æ–ª–Ω—ã–π –ø—É—Ç—å –∫ –ø–æ—Å–ª–µ–¥–Ω–µ–º—É –∏–∑–º–µ–Ω–µ–Ω–Ω–æ–º—É —Ñ–∞–π–ª—É
latest_file_path = os.path.join(folder_path_csv, latest_file)

# –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞ –ª–æ–≥–∞
if not os.path.exists(log_file_path):
    # –°–æ–∑–¥–∞–µ–º —Ñ–∞–π–ª –ª–æ–≥–∞
    open(log_file_path, 'w').close()

# –ó–∞–ø–∏—Å—ã–≤–∞–µ–º –ª–æ–≥ –≤ —Ñ–∞–π–ª
with open(log_file_path, 'r+') as f:
    content = f.read()
    f.seek(0)
    f.write(f"{datetime.now().strftime('%Y-%m-%d %H:%M')} - –ü–æ—Å–ª–µ–¥–Ω–∏–π –∏–∑–º–µ–Ω–µ–Ω–Ω—ã–π —Ñ–∞–π–ª: {latest_file}\n\n" + content)
    
# –ó–∞–≥–æ–ª–æ–≤–∫–∏ –¥–ª—è –æ–±—ä–µ–∫—Ç–æ–≤
headers = [
    "UserName", "AlternameName", "InternetAddress", "Title",
    "Company", "Department", "Manager", "OfficePhone",
    "CorporatePhone", "ExternalPhone"
]

# –°–ª–æ–≤–∞—Ä—å –≤–µ—Å–æ–≤ –¥–æ–ª–∂–Ω–æ—Å—Ç–µ–π (Title)
title_weights = {
    "–£–ø—Ä–∞–≤–ª—è—é—â–∏–π –¥–∏—Ä–µ–∫—Ç–æ—Ä –ü–ê–û \"–Æ–∂–Ω—ã–π –ö—É–∑–±–∞—Å—Å\"": 1,
    "–î–∏—Ä–µ–∫—Ç–æ—Ä –î–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç–∞": 2,
    "–î–∏—Ä–µ–∫—Ç–æ—Ä –¥–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç–∞ - –ì–ª–∞–≤–Ω—ã–π –±—É—Ö–≥–∞–ª—Ç–µ—Ä": 3,
    "–î–∏—Ä–µ–∫—Ç–æ—Ä —Ä–∞–∑—Ä–µ–∑–∞": 4,
    "–î–∏—Ä–µ–∫—Ç–æ—Ä —Å–ª—É–∂–±—ã": 5,
    "–î–∏—Ä–µ–∫—Ç–æ—Ä –£–ø—Ä–∞–≤–ª–µ–Ω–∏—è": 6,
    "–î–∏—Ä–µ–∫—Ç–æ—Ä —É—á–µ–±–Ω–æ–≥–æ —Ü–µ–Ω—Ç—Ä–∞": 7,
    "–î–∏—Ä–µ–∫—Ç–æ—Ä —Ñ–∏–ª–∏–∞–ª–∞": 8,
    "–î–∏—Ä–µ–∫—Ç–æ—Ä —à–∞—Ö—Ç—ã": 9,
    "–î–∏—Ä–µ–∫—Ç–æ—Ä": 10,
    "–°–µ–∫—Ä–µ—Ç–∞—Ä—å –ì–û–§ \"–¢–æ–º—É—Å–∏–Ω—Å–∫–∞—è\"": 11,
    "–°–µ–∫—Ä–µ—Ç–∞—Ä—å –ö—Ä–∞—Å–Ω–æ–≥–æ—Ä—Å–∫–∏–π —Ä–∞–∑—Ä–µ–∑": 12,
    "–°–µ–∫—Ä–µ—Ç–∞—Ä—å –õ–µ–Ω–∏–Ω–∞ —à–∞—Ö—Ç–∞": 13,
    "–°–µ–∫—Ä–µ—Ç–∞—Ä—å –û–ª—å–∂–µ—Ä–∞—Å—Å–∫–∞—è —à–∞—Ö—Ç–∞": 14,
    "–°–µ–∫—Ä–µ—Ç–∞—Ä—å –û–ª—å–∂–µ—Ä–∞—Å—Å–∫–∏–π —Ä–∞–∑—Ä–µ–∑": 15,
    "–°–µ–∫—Ä–µ—Ç–∞—Ä—å –û–§ \"–ö—Ä–∞—Å–Ω–æ–≥–æ—Ä—Å–∫–∞—è\"": 16,
    "–°–µ–∫—Ä–µ—Ç–∞—Ä—å —Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—è": 17,
    "–°–µ–∫—Ä–µ—Ç–∞—Ä—å –°–∏–±–∏—Ä–≥–∏–Ω—Å–∫–∞—è —à–∞—Ö—Ç–∞": 18,
    "–°–µ–∫—Ä–µ—Ç–∞—Ä—å –°–∏–±–∏—Ä–≥–∏–Ω—Å–∫–∏–π —Ä–∞–∑—Ä–µ–∑": 19,
    "–°–µ–∫—Ä–µ—Ç–∞—Ä—å –¢–ê–£ –Æ–ö": 20,
    "–°–µ–∫—Ä–µ—Ç–∞—Ä—å –£–ö–ö": 21,
    "–°–µ–∫—Ä–µ—Ç–∞—Ä—å –£–û–î–£ –Æ–ö": 22,
    "–°–µ–∫—Ä–µ—Ç–∞—Ä—å –£–û–∏–ü–£ –Æ–ö": 23,
    "–°–µ–∫—Ä–µ—Ç–∞—Ä—å –£–ü–î–£ –Æ–ö": 24,
    "–°–µ–∫—Ä–µ—Ç–∞—Ä—å –¶–û–§ \"–ö—É–∑–±–∞—Å—Å–∫–∞—è\"": 25,
    "–°–µ–∫—Ä–µ—Ç–∞—Ä—å –¶–û–§ \"–°–∏–±–∏—Ä—å\"": 26,
    "–°–µ–∫—Ä–µ—Ç–∞—Ä—å –Æ–ö": 27,
    "–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –¥–∏—Ä–µ–∫—Ç–æ—Ä": 28,
    "–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –¥–∏—Ä–µ–∫—Ç–æ—Ä - –î–∏—Ä–µ–∫—Ç–æ—Ä –¥–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç–∞": 29,
    "–ó–∞–º–µ—Å—Ç–∏—Ç–µ–ª—å –¥–∏—Ä–µ–∫—Ç–æ—Ä–∞ –ø–æ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤—É": 30,
    "–ó–∞–º–µ—Å—Ç–∏—Ç–µ–ª—å –¥–∏—Ä–µ–∫—Ç–æ—Ä–∞ –ø–æ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤—É - –ù–∞—á–∞–ª—å–Ω–∏–∫ —Ü–µ—Ö–∞": 31,
    "–ó–∞–º–µ—Å—Ç–∏—Ç–µ–ª—å –¥–∏—Ä–µ–∫—Ç–æ—Ä–∞ –ø–æ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤—É - –ù–∞—á–∞–ª—å–Ω–∏–∫ —Ü–µ—Ö–∞ (–ø–æ–¥–∑–µ–º–Ω—ã–π)": 32,
    "–ü–æ–º–æ—â–Ω–∏–∫ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∞": 33,
    "–†—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è": 34,
    "–†—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ —Ä–µ–º–æ–Ω—Ç–∞–º –∏ —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏ –î–í–°": 35,
    "–†—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å —Å–ª—É–∂–±—ã": 36,
    "–ù–∞—á–∞–ª—å–Ω–∏–∫ –∞–≤—Ç–æ–∫–æ–ª–æ–Ω–Ω—ã": 37,
    "–ù–∞—á–∞–ª—å–Ω–∏–∫ –≥–∞—Ä–∞–∂–∞": 38,
    "–ù–∞—á–∞–ª—å–Ω–∏–∫ –≥—Ä—É–ø–ø—ã": 39,
    "–ù–∞—á–∞–ª—å–Ω–∏–∫ –æ—Ç–¥–µ–ª–∞": 40,
    "–ù–∞—á–∞–ª—å–Ω–∏–∫ –æ—Ç–¥–µ–ª–µ–Ω–∏—è": 41,
    "–ù–∞—á–∞–ª—å–Ω–∏–∫ —Å–º–µ–Ω—ã": 42,
    "–ù–∞—á–∞–ª—å–Ω–∏–∫ —Å–º–µ–Ω—ã –°–∏–±–∏—Ä–≥–∏–Ω—Å–∫–∏–π —Ä–∞–∑—Ä–µ–∑": 43,
    "–ù–∞—á–∞–ª—å–Ω–∏–∫ —Å–º–µ–Ω—ã –Æ–ö": 44,
    "–ù–∞—á–∞–ª—å–Ω–∏–∫ —É—á–∞—Å—Ç–∫–∞": 45,
    "–ù–∞—á–∞–ª—å–Ω–∏–∫ —É—á–∞—Å—Ç–∫–∞ (–ø–æ–¥–∑–µ–º–Ω—ã–π)": 46,
    "–ù–∞—á–∞–ª—å–Ω–∏–∫ —Ü–µ—Ö–∞": 47,
    "–ù–∞—á–∞–ª—å–Ω–∏–∫ —Ü–µ—Ö–∞ - –ì–ª–∞–≤–Ω—ã–π –º–µ—Ö–∞–Ω–∏–∫": 48,
    "–ó–∞–º–µ—Å—Ç–∏—Ç–µ–ª—å –Ω–∞—á–∞–ª—å–Ω–∏–∫–∞ –ø–æ–¥–∑–µ–º–Ω–æ–≥–æ —É—á–∞—Å—Ç–∫–∞": 49,
    "–ó–∞–≤–µ–¥—É—é—â–∏–π —Å–∫–ª–∞–¥–æ–º": 50,
    "–ó–∞–≤–µ–¥—É—é—â–∏–π —Å–∫–ª–∞–¥–æ–º –≤–∑—Ä—ã–≤—á–∞—Ç—ã—Ö –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤": 51,
    "–ü–æ–º–æ—â–Ω–∏–∫ –Ω–∞—á–∞–ª—å–Ω–∏–∫–∞ —É—á–∞—Å—Ç–∫–∞ (–ø–æ–¥–∑–µ–º–Ω—ã–π)": 52,
    "–ü—Ä–µ–¥—Å–µ–¥–∞—Ç–µ–ª—å —Å–æ–≤–µ—Ç–∞ –≤–µ—Ç–µ—Ä–∞–Ω–æ–≤": 53,
    "–ì–ª–∞–≤–Ω—ã–π —ç–∫–æ–Ω–æ–º–∏—Å—Ç": 54,
    "–ì–ª–∞–≤–Ω—ã–π —ç–Ω–µ—Ä–≥–µ—Ç–∏–∫": 55,
    "–ì–ª–∞–≤–Ω—ã–π –≥–µ–æ–ª–æ–≥": 56,
    "–ì–ª–∞–≤–Ω—ã–π –≥–µ–æ–ª–æ–≥ –ø–æ–¥–∑–µ–º–Ω—ã–π": 57,
    "–ì–ª–∞–≤–Ω—ã–π –≥–µ–æ–ª–æ–≥ —Ä–∞–∑—Ä–µ–∑–∞": 58,
    "–ì–ª–∞–≤–Ω—ã–π –∏–Ω–∂–µ–Ω–µ—Ä": 59,
    "–ì–ª–∞–≤–Ω—ã–π –º–∞—Ä–∫—à–µ–π–¥–µ—Ä": 60,
    "–ì–ª–∞–≤–Ω—ã–π –º–∞—Ä–∫—à–µ–π–¥–µ—Ä –ø–æ–¥–∑–µ–º–Ω—ã–π": 61,
    "–ì–ª–∞–≤–Ω—ã–π –º–∞—Ä–∫—à–µ–π–¥–µ—Ä —Ä–∞–∑—Ä–µ–∑–∞": 62,
    "–ì–ª–∞–≤–Ω—ã–π –º–µ—Ö–∞–Ω–∏–∫": 63,
    "–ì–ª–∞–≤–Ω—ã–π —Å–≤–∞—Ä—â–∏–∫": 64,
    "–ì–ª–∞–≤–Ω—ã–π —Ç–µ—Ö–Ω–æ–ª–æ–≥": 65,
    "–ì–ª–∞–≤–Ω—ã–π —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç": 66,
    "–ì–ª–∞–≤–Ω—ã–π —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏": 67,
    "–ì–ª–∞–≤–Ω—ã–π —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç –ø–æ –±—É—Ä–æ–≤–∑—Ä—ã–≤–Ω—ã–º —Ä–∞–±–æ—Ç–∞–º": 68,
    "–ì–ª–∞–≤–Ω—ã–π —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç –ø–æ –≤–Ω–µ—à–Ω–∏–º –∏ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–º –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è–º": 69,
    "–ì–ª–∞–≤–Ω—ã–π —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç –ø–æ –ø–æ–¥–±–æ—Ä—É –∏ –∞–¥–∞–ø—Ç–∞—Ü–∏–∏ –ø–µ—Ä—Å–æ–Ω–∞–ª–∞": 70,
    "–≠–Ω–µ—Ä–≥–µ—Ç–∏–∫": 71,
    "–ó–∞–º–µ—Å—Ç–∏—Ç–µ–ª—å –≥–ª–∞–≤–Ω–æ–≥–æ –∏–Ω–∂–µ–Ω–µ—Ä–∞ –ø–æ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤—É –ø–æ–¥–∑–µ–º–Ω—ã–π": 72,
    "–ú–µ—Ö–∞–Ω–∏–∫": 73,
    "–ú–µ—Ö–∞–Ω–∏–∫ —É—á–∞—Å—Ç–∫–∞": 74,
    "–ú–µ—Ö–∞–Ω–∏–∫ —É—á–∞—Å—Ç–∫–∞ (–ø–æ–¥–∑–µ–º–Ω—ã–π)": 75,
    "–°–º–µ–Ω–Ω—ã–π –º–µ—Ö–∞–Ω–∏–∫": 76,
    "–í–µ–¥—É—â–∏–π –±—É—Ö–≥–∞–ª—Ç–µ—Ä": 77,
    "–ë—É—Ö–≥–∞–ª—Ç–µ—Ä": 78,
    "–í–µ–¥—É—â–∏–π –≥–µ–æ–ª–æ–≥": 79,
    "–í–µ–¥—É—â–∏–π –≥–∏–¥—Ä–æ–≥–µ–æ–ª–æ–≥": 80,
    "–í–µ–¥—É—â–∏–π –≥–æ—Ä–Ω—ã–π –∏–Ω–∂–µ–Ω–µ—Ä": 81,
    "–í–µ–¥—É—â–∏–π –∏–Ω–∂–µ–Ω–µp-–ª–∞–±–æp–∞–Ω—Ç": 82,
    "–í–µ–¥—É—â–∏–π –∏–Ω–∂–µ–Ω–µ—Ä": 83,
    "–í–µ–¥—É—â–∏–π –∏–Ω–∂–µ–Ω–µ—Ä –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –¥–≤–∏–∂–µ–Ω–∏—è": 84,
    "–í–µ–¥—É—â–∏–π –∏–Ω–∂–µ–Ω–µ—Ä –ø–æ –ø—Ä–æ–µ–∫—Ç–Ω–æ-—Å–º–µ—Ç–Ω–æ–π —Ä–∞–±–æ—Ç–µ": 85,
    "–í–µ–¥—É—â–∏–π –∏–Ω–∂–µ–Ω–µ—Ä —ç–ª–µ–∫—Ç—Ä–æ—Å–≤—è–∑–∏": 86,
    "–í–µ–¥—É—â–∏–π –∏–Ω–∂–µ–Ω–µ—Ä-—Å–∏—Å—Ç–µ–º–æ—Ç–µ—Ö–Ω–∏–∫": 87,
    "–ì–æ—Ä–Ω—ã–π –∏–Ω–∂–µ–Ω–µ—Ä": 88,
    "–ò–Ω–∂–µ–Ω–µ—Ä": 89,
    "–ò–Ω–∂–µ–Ω–µ—Ä –ø–æ –∫–æ–º–ø–ª–µ–∫—Ç–∞—Ü–∏–∏ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è": 90,
    "–ò–Ω–∂–µ–Ω–µ—Ä –ø–æ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ–º": 91,
    "–ò–Ω–∂–µ–Ω–µ—Ä –ø–æ –ø—Ä–æ–µ–∫—Ç–Ω–æ-—Å–º–µ—Ç–Ω–æ–π —Ä–∞–±–æ—Ç–µ": 92,
    "–ò–Ω–∂–µ–Ω–µ—Ä —ç–ª–µ–∫—Ç—Ä–æ—Å–≤—è–∑–∏": 93,
    "–ò–Ω–∂–µ–Ω–µ—Ä-–∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä": 94,
    "–ò–Ω–∂–µ–Ω–µ—Ä-—Å–∏—Å—Ç–µ–º–æ—Ç–µ—Ö–Ω–∏–∫": 95,
    "–ò–Ω–∂–µ–Ω–µ—Ä-—ç–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫": 96,
    "–í–µ–¥—É—â–∏–π –º–∞—Ä–∫—à–µ–π–¥–µ—Ä": 97,
    "–í–µ–¥—É—â–∏–π –ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç": 98,
    "–í–µ–¥—É—â–∏–π —Å–∏—Å—Ç–µ–º–Ω—ã–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ-–∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º": 99,
    "–í–µ–¥—É—â–∏–π —Å–∏—Å—Ç–µ–º–Ω—ã–π –∞–Ω–∞–ª–∏—Ç–∏–∫": 100,
    "–í–µ–¥—É—â–∏–π —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç": 101,
    "–í–µ–¥—É—â–∏–π —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏": 102,
    "–í–µ–¥—É—â–∏–π —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç –ø–æ –∑–∞–∫—É–ø–∫–∞–º": 103,
    "–í–µ–¥—É—â–∏–π —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç –ø–æ –∑–µ–º–ª–µ—É—Å—Ç—Ä–æ–π—Å—Ç–≤—É": 104,
    "–í–µ–¥—É—â–∏–π —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç –ø–æ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–º —Å–∏—Å—Ç–µ–º–∞–º": 105,
    "–í–µ–¥—É—â–∏–π —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç –ø–æ –∫–∞—á–µ—Å—Ç–≤—É –ø—Ä–æ–¥—É–∫—Ü–∏–∏": 106,
    "–í–µ–¥—É—â–∏–π —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç –ø–æ –ª–∏—Ü–µ–Ω–∑–∏—Ä–æ–≤–∞–Ω–∏—é": 107,
    "–í–µ–¥—É—â–∏–π —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç –ø–æ –º–∞—Ä–∫–µ—Ç–∏–Ω–≥—É": 108,
    "–í–µ–¥—É—â–∏–π —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç –ø–æ –æ–ø–ª–∞—Ç–µ —Ç—Ä—É–¥–∞": 109,
    "–í–µ–¥—É—â–∏–π —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç –ø–æ –æ—Ö—Ä–∞–Ω–µ —Ç—Ä—É–¥–∞": 110,
    "–í–µ–¥—É—â–∏–π —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç –ø–æ –ø–æ–¥–±–æ—Ä—É –∏ –∞–¥–∞–ø—Ç–∞—Ü–∏–∏ –ø–µ—Ä—Å–æ–Ω–∞–ª–∞": 111,
    "–í–µ–¥—É—â–∏–π —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç –ø–æ –ø–æ–∂–∞—Ä–Ω–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏, –≥—Ä–∞–∂–¥–∞–Ω—Å–∫–æ–π –æ–±–æ—Ä–æ–Ω–µ –∏ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—é —á—Ä–µ–∑–≤—ã—á–∞–π–Ω—ã—Ö —Å–∏—Ç—É–∞—Ü–∏–π": 112,
    "–í–µ–¥—É—â–∏–π —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç –ø–æ –ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏": 113,
    "–í–µ–¥—É—â–∏–π —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç –ø–æ –ø—Ä–æ—á–µ–º—É —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç—É": 114,
    "–í–µ–¥—É—â–∏–π —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç –ø–æ —Ä–∞–±–æ—Ç–µ —Å –ø–µ—Ä—Å–æ–Ω–∞–ª–æ–º": 115,
    "–í–µ–¥—É—â–∏–π —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç –ø–æ —Ä–∞–¥–∏–æ—Å–≤—è–∑–∏ –∏ —Ç–µ–ª–µ–∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è–º": 116,
    "–í–µ–¥—É—â–∏–π —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç –ø–æ —Ä–∞–∑–≤–∏—Ç–∏—é –∏ –æ–±—É—á–µ–Ω–∏—é –ø–µ—Ä—Å–æ–Ω–∞–ª–∞": 117,
    "–í–µ–¥—É—â–∏–π —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç –ø–æ —Å–æ—Ü–∏–∞–ª—å–Ω—ã–º –ø—Ä–æ–≥—Ä–∞–º–º–∞–º": 118,
    "–í–µ–¥—É—â–∏–π —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç –ø–æ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–π –ø–æ–¥–¥–µ—Ä–∂–∫–µ": 119,
    "–í–µ–¥—É—â–∏–π —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç –ø–æ —ç–∫–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏": 120,
    "–í–µ–¥—É—â–∏–π —ç–∫–æ–Ω–æ–º–∏—Å—Ç": 121,
    "–≤–µ–¥—É—â–∏–π —ç–∫–æ–Ω–æ–º–∏—Å—Ç –ø–æ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—é": 122,
    "–í–µ–¥—É—â–∏–π —é—Ä–∏—Å–∫–æ–Ω—Å—É–ª—å—Ç": 123,
    "–í–µ–¥—É—â–∏–π —é—Ä–∏—Å–∫–æ–Ω—Å—É–ª—å—Ç –ø–æ –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–æ–π —Ä–∞–±–æ—Ç–µ": 124,
    "–Æ—Ä–∏—Å–∫–æ–Ω—Å—É–ª—å—Ç": 125,
    "–ì–æ—Ä–Ω—ã–π –º–∞—Å—Ç–µ—Ä": 126,
    "–ì–æ—Ä–Ω—ã–π –º–∞—Å—Ç–µ—Ä –ø–æ–¥–∑–µ–º–Ω—ã–π": 127,
    "–ë—Ä–∏–≥–∞–¥–∏—Ä –Ω–∞ —É—á–∞—Å—Ç–∫–∞—Ö –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞": 128,
    "–°–∏—Å—Ç–µ–º–Ω—ã–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ-–∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º": 129,
    "–°—Ç–∞—Ä—à–∏–π –¥–∏—Å–ø–µ—Ç—á–µ—Ä": 130,
    "–°—Ç–∞—Ä—à–∏–π –∏–Ω–∂–µ–Ω–µ—Ä-—ç–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫": 131,
    "–°—Ç–∞—Ä—à–∏–π –∫–ª–∞–¥–æ–≤—â–∏–∫": 132,
    "–°—Ç–∞—Ä—à–∏–π –ª–∞–±–æ—Ä–∞–Ω—Ç —Ö–∏–º–∏—á–µ—Å–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞": 133,
    "–°—Ç–∞—Ä—à–∏–π –º–∞—Å—Ç–µ—Ä": 134,
    "–°—Ç–∞—Ä—à–∏–π –º–µ—Ö–∞–Ω–∏–∫": 135,
    "—Å—Ç–∞—Ä—à–∏–π –º–µ—Ö–∞–Ω–∏–∫ –ø–æ –∞–≤—Ç–æ–º–∞—Ç–∏–∫–µ –ø–æ–¥–∑–µ–º–Ω—ã–π": 136,
    "–°—Ç–∞—Ä—à–∏–π –º–µ—Ö–∞–Ω–∏–∫ –ø–æ –±—É—Ä–æ–≤—ã–º —Å—Ç–∞–Ω–∫–∞–º¬†": 137,
    "–°—Ç–∞—Ä—à–∏–π –ø—Ä–∏–µ–º–æ—Å–¥–∞—Ç—á–∏–∫ –≥—Ä—É–∑–∞ –∏ –±–∞–≥–∞–∂–∞": 138,
    "–°—Ç–∞—Ä—à–∏–π —ç–Ω–µ—Ä–≥–µ—Ç–∏–∫": 139,
    "–ú–∞—Å—Ç–µ—Ä": 140,
    "–ú–∞—Å—Ç–µ—Ä –±—É—Ä–æ–≤–æ–π": 141,
    "–ú–∞—Å—Ç–µ—Ä –¥–æ—Ä–æ–∂–Ω—ã–π": 142,
    "–ú–∞—Å—Ç–µ—Ä –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–π": 143,
    "–º–∞—Å—Ç–µ—Ä –û–¢–ö —Ä-–∑ –ö—Ä–∞—Å–Ω–æ–≥–æ—Ä—Å–∫–∏–π": 144,
    "–º–∞—Å—Ç–µ—Ä –û–¢–ö –¶–û–§ \"–ö—É–∑–±–∞—Å—Å–∫–∞—è\"": 145,
    "–ú–∞—Å—Ç–µ—Ä –ø–æ —Ä–µ–º–æ–Ω—Ç—É –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è": 146,
    "–ú–∞—Å—Ç–µ—Ä–∞ –û–¢–ö —Ä–∞–∑—Ä–µ–∑ –°–∏–±–∏—Ä–≥–∏–Ω—Å–∫–∏–π": 147,
    "–ê–ø–ø–∞—Ä–∞—Ç—á–∏–∫ —É–≥–ª–µ–æ–±–æ–≥–∞—â–µ–Ω–∏—è": 148,
    "–ê—Ä—Ö–∏–≤–∞—Ä–∏—É—Å": 149,
    "–í–∑—Ä—ã–≤–Ω–∏–∫ –ø–æ–¥–∑–µ–º–Ω—ã–π": 150,
    "–í–æ–¥–∏—Ç–µ–ª—å –ø–æ–≥—Ä—É–∑—á–∏–∫–∞": 151,
    "–ì–µ–æ–ª–æ–≥": 152,
    "–ì–æ—Ä–Ω—ã–π –¥–∏—Å–ø–µ—Ç—á–µ—Ä": 153,
    "–î–µ—Ñ–µ–∫—Ç–æ—Å–∫–æ–ø–∏—Å—Ç –ø–æ —É–ª—å—Ç—Ä–∞–∑–≤—É–∫–æ–≤–æ–º—É –∫–æ–Ω—Ç—Ä–æ–ª—é": 154,
    "–î–∏—Å–ø–µ—Ç—á–µ—Ä": 155,
    "–ö–ª–∞–¥–æ–≤—â–∏–∫": 156,
    "–ö–æ–º–µ–Ω–¥–∞–Ω—Ç": 157,
    "–ö–æ–Ω—Ç—Ä–æ–ª–µ—Ä –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤, –º–µ—Ç–∞–ª–ª–æ–≤, –ø–æ–ª—É—Ñ–∞–±—Ä–∏–∫–∞—Ç–æ–≤ –∏ –∏–∑–¥–µ–ª–∏–π": 158,
    "–ö–æ–Ω—Ç—Ä–æ–ª–µ—Ä –ø–æ —É—á–µ—Ç—É –∏ –∫–æ–Ω—Ç—Ä–æ–ª—é —Ä–∞—Å—Ö–æ–¥–∞ –ì–°–ú": 159,
    "–ö–æ–Ω—Ç—Ä–æ–ª–µ—Ä –ø—Ä–æ–¥—É–∫—Ü–∏–∏ –æ–±–æ–≥–∞—â–µ–Ω–∏—è": 160,
    "–ö–æ–Ω—Ç—Ä–æ–ª–µ—Ä —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∞–≤—Ç–æ–º–æ—Ç–æ—Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤": 161,
    "–ö–æ–Ω—Ç—Ä–æ–ª–µ—Ä-—É—á–µ—Ç—á–∏–∫": 162,
    "–õ–∞–±–æ—Ä–∞–Ω—Ç —Ö–∏–º–∏—á–µ—Å–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞": 163,
    "–õ–∞–º–ø–æ–≤—â–∏–∫": 164,
    "–ú–∞—Ä–∫—à–µ–π–¥–µ—Ä": 165,
    "–ú–∞—à–∏–Ω–∏—Å—Ç –∫–æ–º–ø—Ä–µ—Å—Å–æ—Ä–Ω—ã—Ö —É—Å—Ç–∞–Ω–æ–≤–æ–∫": 166,
    "–ú–∞—à–∏–Ω–∏—Å—Ç –Ω–∞—Å–æ—Å–Ω—ã—Ö —É—Å—Ç–∞–Ω–æ–≤–æ–∫": 167,
    "–û–ø–µ—Ä–∞—Ç–æ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –≥–∞–∑–æ–≤–æ–π –∑–∞—â–∏—Ç—ã": 168,
    "–û–ø–µ—Ä–∞—Ç–æ—Ä –≠–í –∏ –í–ú": 169,
    "–û–ø–µ—Ä–∞—Ç–æ—Ä —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ-–≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω—ã—Ö –∏ –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω—ã—Ö –º–∞—à–∏–Ω": 170,
    "–ü—Ä–∏–µ–º–æ—Å–¥–∞—Ç—á–∏–∫ –≥—Ä—É–∑–∞ –∏ –±–∞–≥–∞–∂–∞": 171,
    "–ü—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç": 172,
    "–†–∞–±–æ—á–∏–π –ø–æ –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–º—É –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—é –∑–¥–∞–Ω–∏–π": 173,
    "–°–∏—Å—Ç–µ–º–Ω—ã–π –∞–Ω–∞–ª–∏—Ç–∏–∫": 174,
    "–°–ª–µ—Å–∞—Ä—å –ø–æ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—é –∏ —Ä–µ–º–æ–Ω—Ç—É –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è": 175,
    "–°–ª–µ—Å–∞—Ä—å –ø–æ —Ä–µ–º–æ–Ω—Ç—É –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π": 176,
    "–°–ª–µ—Å–∞—Ä—å-—Ä–µ–º–æ–Ω—Ç–Ω–∏–∫": 177,
    "–°–ø–µ—Ü–∏–∞–ª–∏—Å—Ç": 178,
    "–°–ø–µ—Ü–∏–∞–ª–∏—Å—Ç –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏": 179,
    "–°–ø–µ—Ü–∏–∞–ª–∏—Å—Ç –ø–æ –≤–Ω–µ—à–Ω–∏–º –∏ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–º –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è–º": 180,
    "–°–ø–µ—Ü–∏–∞–ª–∏—Å—Ç –ø–æ –≥–æ—Ä—é—á–µ-—Å–º–∞–∑–æ—á–Ω—ã–º –º–∞—Ç–µ—Ä–∏–∞–ª–∞–º": 181,
    "–°–ø–µ—Ü–∏–∞–ª–∏—Å—Ç –ø–æ –∑–∞–∫—É–ø–∫–∞–º": 182,
    "–°–ø–µ—Ü–∏–∞–ª–∏—Å—Ç –ø–æ –∑–µ–º–ª–µ—É—Å—Ç—Ä–æ–π—Å—Ç–≤—É": 183,
    "–°–ø–µ—Ü–∏–∞–ª–∏—Å—Ç –ø–æ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–º —Å–∏—Å—Ç–µ–º–∞–º": 184,
    "–°–ø–µ—Ü–∏–∞–ª–∏—Å—Ç –ø–æ –∫–∞–¥—Ä–æ–≤–æ–º—É –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏—é": 185,
    "–°–ø–µ—Ü–∏–∞–ª–∏—Å—Ç –ø–æ –∫–∞—á–µ—Å—Ç–≤—É –ø—Ä–æ–¥—É–∫—Ü–∏–∏": 186,
    "–°–ø–µ—Ü–∏–∞–ª–∏—Å—Ç –ø–æ –ª–∏—Ü–µ–Ω–∑–∏—Ä–æ–≤–∞–Ω–∏—é": 187,
    "–°–ø–µ—Ü–∏–∞–ª–∏—Å—Ç –ø–æ –º–æ–±–∏–ª–∏–∑–∞—Ü–∏–æ–Ω–Ω–æ–π –ø–æ–¥–≥–æ—Ç–æ–≤–∫–µ —ç–∫–æ–Ω–æ–º–∏–∫–∏": 188,
    "–°–ø–µ—Ü–∏–∞–ª–∏—Å—Ç –ø–æ –æ—Ö—Ä–∞–Ω–µ —Ç—Ä—É–¥–∞": 189,
    "–°–ø–µ—Ü–∏–∞–ª–∏—Å—Ç –ø–æ –ø–æ–¥–±–æ—Ä—É –∏ –∞–¥–∞–ø—Ç–∞—Ü–∏–∏ –ø–µ—Ä—Å–æ–Ω–∞–ª–∞": 190,
    "–°–ø–µ—Ü–∏–∞–ª–∏—Å—Ç –ø–æ –ø–æ–∂–∞—Ä–Ω–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏, –≥—Ä–∞–∂–¥–∞–Ω—Å–∫–æ–π –æ–±–æ—Ä–æ–Ω–µ –∏ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—é —á—Ä–µ–∑–≤—ã—á–∞–π–Ω—ã—Ö —Å–∏—Ç—É–∞—Ü–∏–π": 191,
    "–°–ø–µ—Ü–∏–∞–ª–∏—Å—Ç –ø–æ –ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏": 192,
    "–°–ø–µ—Ü–∏–∞–ª–∏—Å—Ç –ø–æ —Ä–∞–±–æ—Ç–µ —Å –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–æ–Ω–Ω—ã–º–∏ –ø—Ä–æ–µ–∫—Ç–∞–º–∏": 193,
    "–°–ø–µ—Ü–∏–∞–ª–∏—Å—Ç –ø–æ —Ä–∞–±–æ—Ç–µ —Å –ø–µ—Ä—Å–æ–Ω–∞–ª–æ–º": 194,
    "–°–ø–µ—Ü–∏–∞–ª–∏—Å—Ç –ø–æ —Ä–∞–∑–≤–∏—Ç–∏—é –∏ –æ–±—É—á–µ–Ω–∏—é –ø–µ—Ä—Å–æ–Ω–∞–ª–∞": 195,
    "–°–ø–µ—Ü–∏–∞–ª–∏—Å—Ç –ø–æ —Å–æ—Ü–∏–∞–ª—å–Ω—ã–º –ø—Ä–æ–≥—Ä–∞–º–º–∞–º": 196,
    "–°–ø–µ—Ü–∏–∞–ª–∏—Å—Ç –ø–æ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–π –ø–æ–¥–¥–µ—Ä–∂–∫–µ": 197,
    "–°–ø–µ—Ü–∏–∞–ª–∏—Å—Ç –ø–æ —ç–∫–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏": 198,
    "–°–ø–µ—Ü–∏–∞–ª–∏—Å—Ç –ø—Ä–æ–ø—É—Å–∫–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞": 199,
    "–¢–µ—Ö–Ω–∏–∫-–∫–∞—Ä—Ç–æ–≥—Ä–∞—Ñ": 200,
    "–¢–æ–≤–∞—Ä–æ–≤–µ–¥": 201,
    "–£—á–∞—Å—Ç–∫–æ–≤—ã–π –≥–µ–æ–ª–æ–≥": 202,
    "–£—á–∞—Å—Ç–∫–æ–≤—ã–π –≥–µ–æ–ª–æ–≥ –ø–æ–¥–∑–µ–º–Ω—ã–π": 203,
    "–£—á–∞—Å—Ç–∫–æ–≤—ã–π –º–∞—Ä–∫—à–µ–π–¥–µ—Ä": 204,
    "–£—á–∞—Å—Ç–∫–æ–≤—ã–π –º–∞—Ä–∫—à–µ–π–¥–µ—Ä –ø–æ–¥–∑–µ–º–Ω—ã–π": 205,
    "–£—á–µ—Ç—á–∏–∫": 206,
    "–≠–∫–æ–Ω–æ–º–∏—Å—Ç": 207,
    "–≠–ª–µ–∫—Ç—Ä–æ–º–µ—Ö–∞–Ω–∏–∫": 208,
    "–≠–ª–µ–∫—Ç—Ä–æ–º–µ—Ö–∞–Ω–∏–∫ –ø–æ –∏—Å–ø—ã—Ç–∞–Ω–∏—é –∏ —Ä–µ–º–æ–Ω—Ç—É —ç–ª–µ–∫—Ç—Ä–æ–æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è": 209,
    "–≠–ª–µ–∫—Ç—Ä–æ–º–æ–Ω—Ç–µ—Ä –ª–∏–Ω–µ–π–Ω—ã—Ö —Å–æ–æ—Ä—É–∂–µ–Ω–∏–π —Ç–µ–ª–µ—Ñ–æ–Ω–Ω–æ–π —Å–≤—è–∑–∏ –∏ —Ä–∞–¥–∏–æ—Ñ–∏–∫–∞—Ü–∏–∏": 210,
    "–≠–ª–µ–∫—Ç—Ä–æ—Å–ª–µ—Å–∞—Ä—å –ø–æ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—é –∏ —Ä–µ–º–æ–Ω—Ç—É –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è": 211,
    "–≠–ª–µ–∫—Ç—Ä–æ—Å–ª–µ—Å–∞—Ä—å –ø–æ–¥–∑–µ–º–Ω—ã–π": 212,
    "–ì–æ—Ä–Ω–æ—Ä–∞–±–æ—á–∏–π": 213,
    "–ì–æ—Ä–Ω–æ—Ä–∞–±–æ—á–∏–π –Ω–∞ –º–∞—Ä–∫—à–µ–π–¥–µ—Ä—Å–∫–∏—Ö —Ä–∞–±–æ—Ç–∞—Ö": 214,
    "–ì–æ—Ä–Ω–æ—Ä–∞–±–æ—á–∏–π –ø–æ–¥–∑–µ–º–Ω—ã–π": 215,
}

try:
    # –°—á–∏—Ç—ã–≤–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–æ–∫ –≤ CSV-—Ñ–∞–π–ª–µ
    with open(latest_file_path, 'r', encoding='utf-8') as file:
        line_count = sum(1 for line in file)
    # –ó–∞–ø–∏—Å—ã–≤–∞–µ–º –ª–æ–≥ –≤ —Ñ–∞–π–ª
    with open(log_file_path, 'r+') as f:
        content = f.read()
        f.seek(0)
        f.write(f"{datetime.now().strftime('%Y-%m-%d %H:%M')} - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–æ–∫ –≤ —Ñ–∞–π–ª–µ: {line_count}\n" + content)

    # –ß–∏—Ç–∞–µ–º –≤—Å–µ —Å—Ç—Ä–æ–∫–∏ —Ñ–∞–π–ª–∞ –≤ –º–∞—Å—Å–∏–≤, –ø—Ä–æ–ø—É—Å–∫–∞—è –ø–µ—Ä–≤—É—é —Å—Ç—Ä–æ–∫—É
    with open(latest_file_path, 'r', encoding='utf-8') as file:
        values = file.readlines()[1:]
    
    # –ú–∞—Å—Å–∏–≤ –æ–±—ä–µ–∫—Ç–æ–≤ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
    objects = []
    no_department_objects = []

    # –ü–µ—Ä–µ–±–∏—Ä–∞–µ–º –º–∞—Å—Å–∏–≤ –ø–æ—Å—Ç—Ä–æ—á–Ω–æ
    for value in values:

        # –†–∞–∑–¥–µ–ª—è–µ–º —Å—Ç—Ä–æ–∫—É –ø–æ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—é
        parts = value.split(";")

        # –ß–∏—Å—Ç–∏–º –ø—Ä–æ–±–µ–ª—ã –≤ –Ω–∞—á–∞–ª–µ –∏ –∫–æ–Ω—Ü–µ –∫–∞–∂–¥–æ–π —á–∞—Å—Ç–∏
        parts = [part.strip() for part in parts]

        # –ß–∏—Å—Ç–∏–º UserName
        parts[0] = parts[0].split("/", 1)[0]
        if parts[0][0] == "\"":  # –£–¥–∞–ª—è–µ–º –ø–µ—Ä–≤—É—é –∫–∞–≤—ã—á–∫—É
            parts[0] = parts[0][1:]

        # –ß–∏—Å—Ç–∏–º AlternameName
        parts[1] = parts[1].split("/", 1)[0]

        # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ parts[2] (e-mail) –Ω–µ –ø—É—Å—Ç–æ–π
        if parts[2]:
            # –†–∞–∑–¥–µ–ª—è–µ–º parts[1] –Ω–∞ —á–∞—Å—Ç–∏ –ø–æ –ø—Ä–æ–±–µ–ª—É
            name_parts = parts[1].split()
            # –ò—Å–ø–æ–ª—å–∑—É–µ–º –ø—Ä–µ–¥–ø–æ—Å–ª–µ–¥–Ω–∏–π –∏ –ø–æ—Å–ª–µ–¥–Ω–∏–π —ç–ª–µ–º–µ–Ω—Ç –º–∞—Å—Å–∏–≤–∞ –¥–ª—è –∏–º–µ–Ω–∏ –∏ —Ñ–∞–º–∏–ª–∏–∏
            if len(name_parts) >= 2:
                first_name = name_parts[-2]
                last_name = name_parts[-1]
                # –°–æ–∑–¥–∞–µ–º —Å—Ç—Ä–æ–∫—É —Å –∏–º–µ–Ω–µ–º –∏ —Ñ–∞–º–∏–ª–∏–µ–π –¥–ª—è —Ç–µ–ª–∞ –ø–∏—Å—å–º–∞
                body_content = f"{first_name} {last_name},\n\n"
            else:
                # –ï—Å–ª–∏ –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —á–∞—Å—Ç–µ–π –¥–ª—è –∏–º–µ–Ω–∏ –∏ —Ñ–∞–º–∏–ª–∏–∏, –∏—Å–ø–æ–ª—å–∑—É–µ–º parts[1] —Ü–µ–ª–∏–∫–æ–º
                body_content = f"{parts[1]}\n\n"

            # –°–æ–∑–¥–∞–µ–º —Å—Å—ã–ª–∫—É mailto —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º body
            mailto_link = f'mailto:{parts[2]}?body={body_content}'
            # –î–æ–±–∞–≤–ª—è–µ–º emoji email –≤ –Ω–∞—á–∞–ª–æ —Å—Ç—Ä–æ–∫–∏ parts[1]
            parts[1] = f'=HYPERLINK("{mailto_link}", "üìß {parts[1]}")'
            
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º –∏ –∑–∞–º–µ–Ω—è–µ–º —Å—Ç—Ä–æ–∫—É –ø–µ—Ä–µ–¥ —Å–ø–ª–∏—Ç–æ–º
        if "–≠–®-20/90" in parts[5]:
            parts[5] = parts[5].replace("–≠–®-20/90", "–≠–®-20|90")

        # –ü–µ—Ä–µ–≤–æ—Ä–∞—á–∏–≤–∞–µ–º Department –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏
        dep_tmp = parts[5].split("/")
        dep_tmp.reverse()
        parts[5] = "/".join(dep_tmp)

        # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —Å–æ–¥–µ—Ä–∂–∏—Ç –ª–∏ parts[5] "/0400" –∏ –æ–±—Ä–µ–∑–∞–µ–º —Å—Ç—Ä–æ–∫—É, –æ—Å—Ç–∞–≤–ª—è—è "0400" –∏ –≤—Å–µ, —á—Ç–æ –ø–æ—Å–ª–µ
        if "/0400" in parts[5]:
            index = parts[5].index("/0400")
            parts[5] = parts[5][index + 1:]  # –û—Å—Ç–∞–≤–ª—è–µ–º "0400" –∏ –≤—Å–µ, —á—Ç–æ –ø–æ—Å–ª–µ –Ω–µ–≥–æ
            parts[5] = parts[5].replace("0400.  ", "0400. ")  # –£–±–∏—Ä–∞–µ–º –ª–∏—à–Ω–∏–π –ø—Ä–æ–±–µ–ª
            
        # –ß–∏—Å—Ç–∏–º Manager
        parts[6] = parts[6].split("/", 1)[0]

        # –ü—Ä–∞–≤–∏–º OfficePhone (–∑–¥–µ—Å—å - —Å–æ—Ç–æ–≤—ã–π –∏–ª–∏ –ú–ì –∫–æ–¥)
        if parts[7]:
            if "38475" in parts[7]:
                parts[7] = parts[7].replace("38475", " (38475) ")
            else:
                if "38474" in parts[7]:
                    parts[7] = parts[7].replace("38474", " (38474) ")
                elif len(parts[7]) <= 12:
                    parts[7] = parts[7][:-10] + " " + parts[7][-10:-7] + "-" + parts[7][-7:-4] + "-" + parts[7][-4:-2] + "-" + parts[7][-2:]

        # –ü—Ä–∞–≤–∏–º CorporatePhone
        if parts[8] != '':
            parts[8] = parts[8][:1] + "-" + parts[8][1:3] + "-" + parts[8][3:]

        # –ü—Ä–∞–≤–∏–º ExternalPhone (–∑–¥–µ—Å—å - 4—Ö –∑–Ω–∞—á–Ω—ã–π –æ—Ñ–∏—Å–Ω—ã–π –Ω–æ–º–µ—Ä)
        parts[9] = parts[9].strip()  # –£–±–∏—Ä–∞–µ–º –ø–æ—Å–ª–µ–¥–Ω–∏–µ –ø—Ä–æ–±–µ–ª—ã –∏ —Å–∏–º–≤–æ–ª—ã –ø–µ—Ä–µ–≤–æ–¥–∞ —Å—Ç—Ä–æ–∫–∏

        # –ï—Å–ª–∏ –ø–æ—Å–ª–µ–¥–Ω–∏–π —Å–∏–º–≤–æ–ª –∫–∞–≤—ã—á–∫–∞, —É–¥–∞–ª—è–µ–º –µ–≥–æ –∏ –æ—á–∏—â–∞–µ–º –ø—Ä–æ–±–µ–ª—ã
        if parts[9] and parts[9][-1] == "\"":
            parts[9] = parts[9][:-1].strip()
        if parts[9] and len(parts[9]) > 5:  # –ï—Å–ª–∏ –ø–æ–ª–µ –Ω–µ –ø—É—Å—Ç–æ–µ –∏ –¥–ª–∏–Ω–∞ —Å—Ç—Ä–æ–∫–∏ –±–æ–ª—å—à–µ 5 —Å–∏–º–≤–æ–ª–æ–≤
            parts[9] = parts[9][:2] + "-" + parts[9][2:-2] + "-" + parts[9][-2:]
        elif parts[9]:
            parts[9] = parts[9][:-2] + "-" + parts[9][-2:]


        # –ï—Å–ª–∏ ExternalPhone –ø—É—Å—Ç–æ–π, –±–µ—Ä–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ CorporatePhone, –µ—Å–ª–∏ –∏ —Ç–æ—Ç –ø—É—Å—Ç–æ–π - –∏–∑ OfficePhone
        if not parts[9]:
            parts[9] = parts[8].strip() if parts[8] else parts[7].strip()

        # –ï—Å–ª–∏ –ø–æ—Å–ª–µ –∑–∞–º–µ–Ω—ã parts[9] –≤—Å–µ –µ—â–µ –ø—É—Å—Ç–æ–π, –¥–æ–±–∞–≤–ª—è–µ–º –≤ no_department_objects
        if not parts[9] and not parts[8] and not parts[7]:
            no_department_objects.append(dict(zip(headers, parts)))
        else:
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ —á–µ—Ç—ã—Ä–µ—Ö —Ü–∏—Ñ—Ä –ø–æ–¥—Ä—è–¥ –≤ –Ω–∞—á–∞–ª–µ —Å—Ç—Ä–æ–∫–∏ –≤ –ø–æ–ª–µ Department
            department_field = parts[5]

            # –ò—â–µ–º —á–µ—Ç—ã—Ä–µ —Ü–∏—Ñ—Ä—ã –ø–æ–¥—Ä—è–¥ –≤ –Ω–∞—á–∞–ª–µ —Å—Ç—Ä–æ–∫–∏ –∏–ª–∏ –≤ —Å–µ—Ä–µ–¥–∏–Ω–µ —Å—Ç—Ä–æ–∫–∏
            if not re.search(r'\b\d{4}\b', department_field) and not "29." in department_field:
                no_department_objects.append(dict(zip(headers, parts)))
            else:
                # –°–æ–∑–¥–∞–µ–º –æ–±—ä–µ–∫—Ç —Å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–º–∏ –∫–ª—é—á–∞–º–∏ –∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏
                if len(parts) == len(headers):  # –£–±–µ–¥–∏–º—Å—è, —á—Ç–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–Ω–∞—á–µ–Ω–∏–π —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤
                    obj = dict(zip(headers, parts))
                    objects.append(obj)

    # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±—ä–µ–∫—Ç–æ–≤ –≤ –º–∞—Å—Å–∏–≤–µ
    object_count = len(objects)
    # –ó–∞–ø–∏—Å—ã–≤–∞–µ–º –ª–æ–≥ –≤ —Ñ–∞–π–ª
    with open(log_file_path, 'r+') as f:
        content = f.read()
        f.seek(0)
        f.write(f"{datetime.now().strftime('%Y-%m-%d %H:%M')} - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±—ä–µ–∫—Ç–æ–≤ –≤ –º–∞—Å—Å–∏–≤–µ: {object_count}\n" + content)    

    # –û—Ç—Ñ–∏–ª—å—Ç—Ä—É–µ–º —Å—Ç—Ä–æ–∫–∏ —Å –ø—É—Å—Ç—ã–º –ø–æ–ª–µ–º Department
    no_department_objects.extend([obj for obj in objects if not obj.get("Department", "").strip()])
    with_department_objects = [obj for obj in objects if obj.get("Department", "").strip()]

    # –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –≤–µ—Å–∞ Title
    def get_title_weight(title):
        return title_weights.get(title, 0)  # –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç 0, –µ—Å–ª–∏ title –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ —Å–ª–æ–≤–∞—Ä–µ

    # –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞ Department
    def department_priority(department):
        if "0100.01. –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ü–∏—è –ü–ê–û \"–Æ–∂–Ω—ã–π –ö—É–∑–±–∞—Å—Å\"" in department:
            return 0  # –í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç –¥–ª—è "0100.01. –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ü–∏—è –ü–ê–û \"–Æ–∂–Ω—ã–π –ö—É–∑–±–∞—Å—Å\""
        elif department == "0100. –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ü–∏—è":
            return 1  # –°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç –¥–ª—è "0100. –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ü–∏—è"
        else:
            return 2  # –ù–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç –¥–ª—è –≤—Å–µ—Ö –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –¥–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç–æ–≤

    # –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –æ–±—ä–µ–∫—Ç–æ–≤: —Å–Ω–∞—á–∞–ª–∞ –ø–æ Department —Å —É—á–µ—Ç–æ–º –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞, –∑–∞—Ç–µ–º –ø–æ Title —Å —É—á–µ—Ç–æ–º –≤–µ—Å–∞
    with_department_objects.sort(
        key=lambda x: (department_priority(x.get("Department", "")), x.get("Department", ""), get_title_weight(x.get("Title", "")))
    )
    # –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –æ–±—ä–µ–∫—Ç–æ–≤ –±–µ–∑ –¥–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç–∞
    no_department_objects.sort(
        key=lambda x: (department_priority(x.get("Department", "")), x.get("Department", ""), get_title_weight(x.get("Title", "")))
    )

    # –§—É–Ω–∫—Ü–∏—è –¥–ª—è –≤—Å—Ç–∞–≤–∫–∏ –∫–æ–ø–∏–π —Å—Ç—Ä–æ–∫ –ø–µ—Ä–µ–¥ —Å—Ç—Ä–æ–∫–∞–º–∏, –Ω–∞—á–∏–Ω–∞—é—â–∏–º–∏—Å—è —Å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–≥–æ –¥–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç–∞
    def insert_before_department(with_department_objects, target_department, startswith_department):
        # –ò—â–µ–º —Å—Ç—Ä–æ–∫–∏ —Å –Ω—É–∂–Ω—ã–º Department
        target_objects = [obj for obj in with_department_objects if obj.get("Department", "") == target_department]

        # –ò—â–µ–º –∏–Ω–¥–µ–∫—Å –ø–µ—Ä–≤–æ–π —Å—Ç—Ä–æ–∫–∏, –Ω–∞—á–∏–Ω–∞—é—â–µ–π—Å—è —Å startswith_department
        insert_index = next((i for i, obj in enumerate(with_department_objects) if obj.get("Department", "").startswith(startswith_department)), None)

        # –í—Å—Ç–∞–≤–ª—è–µ–º –Ω–∞–π–¥–µ–Ω–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏ –ø–µ—Ä–µ–¥ –ø–µ—Ä–≤–æ–π —Å—Ç—Ä–æ–∫–æ–π, –Ω–∞—á–∏–Ω–∞—é—â–µ–π—Å—è —Å startswith_department
        if insert_index is not None:
            with_department_objects[insert_index:insert_index] = target_objects
        else:
            # –ï—Å–ª–∏ –Ω–µ –Ω–∞—à–ª–∏, –¥–æ–±–∞–≤–ª—è–µ–º —Å—Ç—Ä–æ–∫–∏ –≤ –∫–æ–Ω–µ—Ü
            with_department_objects.extend(target_objects)

    # –í—Å—Ç–∞–≤–∫–∞ –¥–ª—è "0200. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ —ç–∫–æ–Ω–æ–º–∏–∫–µ –∏ —Ñ–∏–Ω–∞–Ω—Å–∞–º"
    insert_before_department(
        with_department_objects,
        "0100.01. –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ü–∏—è –ü–ê–û \"–Æ–∂–Ω—ã–π –ö—É–∑–±–∞—Å—Å\"/0200. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ —ç–∫–æ–Ω–æ–º–∏–∫–µ –∏ —Ñ–∏–Ω–∞–Ω—Å–∞–º",
        "0200. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ —ç–∫–æ–Ω–æ–º–∏–∫–µ –∏ —Ñ–∏–Ω–∞–Ω—Å–∞–º"
    )

    # –í—Å—Ç–∞–≤–∫–∞ –¥–ª—è "0400. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏"
    insert_before_department(
        with_department_objects,
        "0100.01. –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ü–∏—è –ü–ê–û \"–Æ–∂–Ω—ã–π –ö—É–∑–±–∞—Å—Å\"/0400. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏",
        "0400. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏"
    )

    # –í—Å—Ç–∞–≤–∫–∞ –¥–ª—è "0600. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ —Ä–∞–±–æ—Ç–µ —Å –ø–µ—Ä—Å–æ–Ω–∞–ª–æ–º"
    insert_before_department(
        with_department_objects,
        "0100.01. –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ü–∏—è –ü–ê–û \"–Æ–∂–Ω—ã–π –ö—É–∑–±–∞—Å—Å\"/0600. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ —Ä–∞–±–æ—Ç–µ —Å –ø–µ—Ä—Å–æ–Ω–∞–ª–æ–º",
        "0600. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ —Ä–∞–±–æ—Ç–µ —Å –ø–µ—Ä—Å–æ–Ω–∞–ª–æ–º"
    )

    # –í—Å—Ç–∞–≤–∫–∞ –¥–ª—è "0700. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏"
    insert_before_department(
        with_department_objects,
        "0100.01. –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ü–∏—è –ü–ê–û \"–Æ–∂–Ω—ã–π –ö—É–∑–±–∞—Å—Å\"/0700. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏",
        "0700. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏"
    )

    # –°–æ–∑–¥–∞–µ–º DataFrame –∏–∑ –æ–±—ä–µ–∫—Ç–æ–≤ —Å –Ω—É–∂–Ω—ã–º–∏ –∫–æ–ª–æ–Ω–∫–∞–º–∏ –∏ –¥–æ–±–∞–≤–ª—è–µ–º —Å—Ç–æ–ª–±–µ—Ü Department
    filtered_df = pd.DataFrame(with_department_objects, columns=["Title", "AlternameName", "ExternalPhone", "Department"])
    no_department_df = pd.DataFrame(no_department_objects, columns=["Title", "AlternameName", "ExternalPhone", "Department"])

    output_file_path = os.path.join(folder_path_sprav, "–ü–ê–û –Æ–∂–Ω—ã–π –ö—É–∑–±–∞—Å—Å.xlsx")
    with pd.ExcelWriter(output_file_path, engine="openpyxl") as writer:
        filtered_df.to_excel(writer, index=False, header=False, sheet_name="–Æ–ö")  # –õ–∏—Å—Ç "–Æ–ö"
        no_department_df.to_excel(writer, index=False, header=False, sheet_name="NoDepartment")  # –õ–∏—Å—Ç "NoDepartment"

    # –û—Ç–∫—Ä—ã–≤–∞–µ–º —Å–æ–∑–¥–∞–Ω–Ω—ã–π —Ñ–∞–π–ª –¥–ª—è —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
    wb = load_workbook(output_file_path)
    ws_with_department = wb["–Æ–ö"]
    ws_no_department = wb["NoDepartment"]

    # –í—Å—Ç–∞–≤–ª—è–µ–º –¥–≤–µ —Å—Ç—Ä–æ–∫–∏ –≤ –Ω–∞—á–∞–ª–æ –ª–∏—Å—Ç–∞ "–Æ–ö"
    ws_with_department.insert_rows(1, 2)

    # –û–±—ä–µ–¥–∏–Ω—è–µ–º —è—á–µ–π–∫–∏ A1:C1 –∏ A2:C2
    ws_with_department.merge_cells('A1:C1')
    ws_with_department.merge_cells('A2:C2')

    # –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –ø–µ—Ä–≤–æ–π —Å—Ç—Ä–æ–∫–∏
    header_font = Font(name="Times New Roman", size=36, bold=True, color="0000FF")  # –°–∏–Ω–∏–π —Ü–≤–µ—Ç
    alignment_center = Alignment(horizontal="center", vertical="center")

    # –ó–∞–ø–æ–ª–Ω—è–µ–º –ø–µ—Ä–≤—É—é —Å—Ç—Ä–æ–∫—É —Ç–µ–∫—Å—Ç–æ–º –∏ –ø—Ä–∏–º–µ–Ω—è–µ–º —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
    ws_with_department['A1'].value = "–¢–µ–ª–µ—Ñ–æ–Ω–Ω—ã–π —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫"
    ws_with_department['A1'].font = header_font
    ws_with_department['A1'].alignment = alignment_center

    # –ó–∞–ø–æ–ª–Ω—è–µ–º –≤—Ç–æ—Ä—É—é —Å—Ç—Ä–æ–∫—É —Ç–µ–∫—Å—Ç–æ–º –∏ –ø—Ä–∏–º–µ–Ω—è–µ–º —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
    ws_with_department['A2'].value = '–ü–ê–û "–Æ–∂–Ω—ã–π –ö—É–∑–±–∞—Å—Å"'
    ws_with_department['A2'].font = header_font
    ws_with_department['A2'].alignment = alignment_center

    # –ó–∞–∫—Ä–µ–ø–ª—è–µ–º –ø–µ—Ä–≤—ã–µ —Ç—Ä–∏ —Å—Ç—Ä–æ–∫–∏ –≤–≤–µ—Ä—Ö—É —Å—Ç—Ä–∞–Ω–∏—Ü—ã
    ws_with_department.freeze_panes = 'A4'

    # –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç–æ–ª–±—Ü–æ–≤ (–Ω–∞—á–∏–Ω–∞—è —Å 3-–π —Å—Ç—Ä–æ–∫–∏)
    column_formats = {
        "A": {"width": 50, "font": Font(name="Times New Roman", size=10, bold=True, italic=True), "wrap_text": True},  # Title with wrap text
        "B": {"width": 62, "font": Font(name="Times New Roman", size=12, bold=True)},  # AlternameName
        "C": {"width": 30, "font": Font(name="Times New Roman", size=14, bold=True), "alignment": Alignment(horizontal="center", vertical="center")},  # ExternalPhone
        "D": {"width": 9, "font": Font(size=10), "alignment": Alignment(vertical="center")}  # Department
    }

    for col, fmt in column_formats.items():
        # –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —à–∏—Ä–∏–Ω—É —Å—Ç–æ–ª–±—Ü–∞ –¥–ª—è –ª–∏—Å—Ç–∞ —Å Department
        ws_with_department.column_dimensions[col].width = fmt["width"]

        # –ü—Ä–∏–º–µ–Ω—è–µ–º —à—Ä–∏—Ñ—Ç –∏ –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ –∫ —è—á–µ–π–∫–∞–º —Å—Ç–æ–ª–±—Ü–∞, –Ω–∞—á–∏–Ω–∞—è —Å —Ç—Ä–µ—Ç—å–µ–π —Å—Ç—Ä–æ–∫–∏
        if "font" in fmt:
            for cell in ws_with_department[col][2:]:  # –ù–∞—á–∏–Ω–∞–µ–º —Å 3-–π —Å—Ç—Ä–æ–∫–∏, —Ç–∞–∫ –∫–∞–∫ 1 –∏ 2 –∑–∞–Ω—è—Ç—ã –∑–∞–≥–æ–ª–æ–≤–∫–∞–º–∏
                cell.font = fmt["font"]
                if col in ["A", "B", "D"]:
                    cell.alignment = Alignment(horizontal="left", vertical="center", wrap_text=fmt.get("wrap_text", False))
                elif col == "C":
                    cell.alignment = fmt.get("alignment", Alignment(horizontal="center", vertical="center"))
                else:
                    cell.alignment = Alignment(horizontal="center", vertical="center")

        # –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —à–∏—Ä–∏–Ω—É —Å—Ç–æ–ª–±—Ü–∞ –¥–ª—è –ª–∏—Å—Ç–∞ –±–µ–∑ Department
        ws_no_department.column_dimensions[col].width = fmt["width"]

        # –ü—Ä–∏–º–µ–Ω—è–µ–º —à—Ä–∏—Ñ—Ç –∏ –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ –∫ —è—á–µ–π–∫–∞–º —Å—Ç–æ–ª–±—Ü–∞, –µ—Å–ª–∏ —É–∫–∞–∑–∞–Ω–æ
        if "font" in fmt:
            for cell in ws_no_department[col]:
                cell.font = fmt["font"]
                if col in ["A", "B", "D"]:
                    cell.alignment = Alignment(horizontal="left", vertical="center", wrap_text=fmt.get("wrap_text", False))
                elif col == "C":
                    cell.alignment = fmt.get("alignment", Alignment(horizontal="center", vertical="center"))
                else:
                    cell.alignment = Alignment(horizontal="center", vertical="center")

    def process_departments_and_insert_rows(sheet, department_column_index):
        """
        –§—É–Ω–∫—Ü–∏—è –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –¥–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç—ã –∏ –≤—Å—Ç–∞–≤–ª—è–µ—Ç —Å—Ç—Ä–æ–∫—É –∑–∞–≥–æ–ª–æ–≤–∫–∞ –ø–µ—Ä–µ–¥ —Å—Ç—Ä–æ–∫–æ–π,
        –≥–¥–µ –∏–∑–º–µ–Ω—è–µ—Ç—Å—è –¥–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç, –∏—Å–∫–ª—é—á–∞—è –ø–µ—Ä–≤—ã–π —Å–ª—É—á–∞–π —É–∫–∞–∑–∞–Ω–Ω—ã—Ö –¥–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç–æ–≤.
        
        :param sheet: –õ–∏—Å—Ç Excel, –∫–æ—Ç–æ—Ä—ã–π –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å.
        :param department_column_index: –ò–Ω–¥–µ–∫—Å –∫–æ–ª–æ–Ω–∫–∏, –≤ –∫–æ—Ç–æ—Ä–æ–π –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –¥–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç.
        """
        previous_department = None

        # –û–ø—Ä–µ–¥–µ–ª—è–µ–º –¥–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç—ã, –¥–ª—è –∫–æ—Ç–æ—Ä—ã—Ö –Ω—É–∂–Ω–æ –∏—Å–∫–ª—é—á–∏—Ç—å –ø–µ—Ä–≤—É—é –≤—Å—Ç–∞–≤–∫—É
        exclude_departments = {
            "0100.01. –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ü–∏—è –ü–ê–û \"–Æ–∂–Ω—ã–π –ö—É–∑–±–∞—Å—Å\"/0200. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ —ç–∫–æ–Ω–æ–º–∏–∫–µ –∏ —Ñ–∏–Ω–∞–Ω—Å–∞–º",
            "0100.01. –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ü–∏—è –ü–ê–û \"–Æ–∂–Ω—ã–π –ö—É–∑–±–∞—Å—Å\"/0600. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ —Ä–∞–±–æ—Ç–µ —Å –ø–µ—Ä—Å–æ–Ω–∞–ª–æ–º",
            "0100.01. –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ü–∏—è –ü–ê–û \"–Æ–∂–Ω—ã–π –ö—É–∑–±–∞—Å—Å\"/0700. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏"
        }

        # –ú–Ω–æ–∂–µ—Å—Ç–≤–æ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è —É–∂–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö –¥–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç–æ–≤
        seen_departments = set()

        # –°–ø–∏—Å–æ–∫ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Å—Ç—Ä–æ–∫, –≥–¥–µ –Ω—É–∂–Ω–æ –≤—Å—Ç–∞–≤–∏—Ç—å –∑–∞–≥–æ–ª–æ–≤–∫–∏
        rows_to_insert = []

        # –ü—Ä–æ—Ö–æ–¥–∏–º –ø–æ —Å—Ç—Ä–æ–∫–∞–º
        for row_index, row in enumerate(sheet.iter_rows(min_row=2, values_only=True), start=2):
            current_department = row[department_column_index - 1]  # –ü–æ–ª—É—á–∞–µ–º —Ç–µ–∫—É—â–∏–π –¥–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç –∏–∑ —Å—Ç—Ä–æ–∫–∏

            # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω—É–∂–Ω–æ –ª–∏ –∏—Å–∫–ª—é—á–∏—Ç—å –≤—Å—Ç–∞–≤–∫—É –∑–∞–≥–æ–ª–æ–≤–∫–∞ –¥–ª—è –ø–µ—Ä–≤–æ–≥–æ –ø–æ—è–≤–ª–µ–Ω–∏—è –¥–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç–∞
            if current_department != previous_department and current_department is not None:
                if current_department in exclude_departments:
                    if current_department not in seen_departments:
                        seen_departments.add(current_department)
                    else:
                        # –ï—Å–ª–∏ –¥–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç —É–∂–µ –≤—Å—Ç—Ä–µ—á–∞–ª—Å—è, –¥–æ–±–∞–≤–ª—è–µ–º –∏–Ω–¥–µ–∫—Å –¥–ª—è –≤—Å—Ç–∞–≤–∫–∏ –∑–∞–≥–æ–ª–æ–≤–∫–∞
                        rows_to_insert.append(row_index)
                else:
                    # –ï—Å–ª–∏ –¥–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç –Ω–µ –≤ —Å–ø–∏—Å–∫–µ –∏—Å–∫–ª—é—á–µ–Ω–∏–π, –¥–æ–±–∞–≤–ª—è–µ–º –∏–Ω–¥–µ–∫—Å –¥–ª—è –≤—Å—Ç–∞–≤–∫–∏ –∑–∞–≥–æ–ª–æ–≤–∫–∞
                    rows_to_insert.append(row_index)

            # –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–π –¥–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç
            previous_department = current_department

        # –ü—Ä—è–º–æ–π –ø–æ—Ä—è–¥–æ–∫ –≤—Å—Ç–∞–≤–∫–∏ —Å –ø–µ—Ä–µ—Å—á–µ—Ç–æ–º –∏–Ω–¥–µ–∫—Å–æ–≤
        for i, insert_index in enumerate(rows_to_insert):
            # –ü–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ–º –∏–Ω–¥–µ–∫—Å –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —É–∂–µ –≤—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã—Ö —Å—Ç—Ä–æ–∫
            corrected_index = insert_index + i

            # –í—Å—Ç–∞–≤–ª—è–µ–º —Å—Ç—Ä–æ–∫—É –ø–µ—Ä–µ–¥ —Ç–µ–∫—É—â–µ–π —Å—Ç—Ä–æ–∫–æ–π
            sheet.insert_rows(corrected_index)

            # –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ç–µ–∫—Å—Ç –¥–ª—è –æ–±—ä–µ–¥–∏–Ω–µ–Ω–Ω–æ–π —è—á–µ–π–∫–∏
            # –ù—É–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å –¥–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç –∏–∑ —Å—Ç—Ä–æ–∫–∏ –Ω–∏–∂–µ, –∫–æ—Ç–æ—Ä–∞—è —Å–º–µ—Å—Ç–∏—Ç—Å—è
            current_department = sheet.cell(row=corrected_index + 1, column=department_column_index).value
            if current_department is None:
                current_department = ""
            
            if '/' in current_department:
                text_to_insert = current_department.split('/')[-1].strip()
            else:
                text_to_insert = current_department

            # –û–±—ä–µ–¥–∏–Ω—è–µ–º —è—á–µ–π–∫–∏ A, B, –∏ C –≤ –Ω–æ–≤–æ–π —Å—Ç—Ä–æ–∫–µ
            sheet.merge_cells(start_row=corrected_index, start_column=1, end_row=corrected_index, end_column=3)

            # –í—Å—Ç–∞–≤–ª—è–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ –≤ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–Ω—É—é —è—á–µ–π–∫—É
            merged_cell = sheet.cell(row=corrected_index, column=1)
            merged_cell.value = text_to_insert

            # –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –≤—Å—Ç–∞–≤–ª–µ–Ω–Ω–æ–π —Å—Ç—Ä–æ–∫–∏
            font_style = Font(name="Times New Roman", size=14, bold=True, italic=True, color="000080")  # –°–∏–Ω–∏–π –∫—É—Ä—Å–∏–≤ –∂–∏—Ä–Ω—ã–π
            alignment_style = Alignment(horizontal="center", vertical="center")  # –í—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ –ø–æ —Ü–µ–Ω—Ç—Ä—É
            fill_style = PatternFill(start_color="CCFFCC", end_color="CCFFCC", fill_type="solid")  # –°–≤–µ—Ç–ª–æ-–∑–µ–ª–µ–Ω—ã–π —Ü–≤–µ—Ç

            # –ü—Ä–∏–º–µ–Ω—è–µ–º —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–Ω–æ–π —è—á–µ–π–∫–µ
            merged_cell.font = font_style
            merged_cell.alignment = alignment_style

            # –ü—Ä–∏–º–µ–Ω—è–µ–º —Ü–≤–µ—Ç —Ñ–æ–Ω–∞ —Ç–æ–ª—å–∫–æ –∫ —è—á–µ–π–∫–∞–º A, B –∏ C
            for col in range(1, 4):  # –ö–æ–ª–æ–Ω–∫–∏ A (1), B (2), C (3)
                cell = sheet.cell(row=corrected_index, column=col)
                cell.fill = fill_style

        # –ó–∞–ø–∏—Å—ã–≤–∞–µ–º –ª–æ–≥ –≤ —Ñ–∞–π–ª
        with open(log_file_path, 'r+') as f:
            content = f.read()
            f.seek(0)
            f.write(f"{datetime.now().strftime('%Y-%m-%d %H:%M')} - –î–æ–±–∞–≤–ª–µ–Ω–æ {len(rows_to_insert)} –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤\n" + content)    

    process_departments_and_insert_rows(ws_with_department, department_column_index=4)

    # –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ñ–∞–π–ª –∏ —Å –Ω–æ–≤—ã–º –∏–º–µ–Ω–µ–º –ª–∏—Å—Ç–∞
    wb.save(output_file_path)

    # –ó–∞–ø–∏—Å—ã–≤–∞–µ–º –ª–æ–≥ –≤ —Ñ–∞–π–ª
    with open(log_file_path, 'r+') as f:
        content = f.read()
        f.seek(0)
        f.write(f"{datetime.now().strftime('%Y-%m-%d %H:%M')} - –î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –∏ –æ—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω—ã –≤ —Ñ–∞–π–ª: {output_file_path}\n" + content)    
    
except Exception as e:
    # –ó–∞–ø–∏—Å—ã–≤–∞–µ–º –ª–æ–≥ –≤ —Ñ–∞–π–ª
    with open(log_file_path, 'r+') as f:
        content = f.read()
        f.seek(0)
        f.write(f"{datetime.now().strftime('%Y-%m-%d %H:%M')} - –û—à–∏–±–∫–∞ –ø—Ä–∏ —á—Ç–µ–Ω–∏–∏ —Ñ–∞–π–ª–∞: {e}\n" + content)    

# –î–û–ë–ê–í–õ–ï–ù–ò–ï –î–û–ü–û–õ–ù–ï–ù–ò–ô

# –ó–∞–≥—Ä—É–∑–∫–∞ —Ü–µ–ª–µ–≤–æ–≥–æ —Ñ–∞–π–ª–∞
wb_target = load_workbook(target_file_path)
ws_target = wb_target.active

# –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–∞ —Å –¥–æ–ø–æ–ª–Ω–µ–Ω–∏—è–º–∏
wb_add = load_workbook(add_file_path)
ws_add = wb_add.active

# –ü–æ–¥—Å—á–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Å—Ç—Ä–æ–∫ –≤ —Ñ–∞–π–ª–µ –¥–æ–ø–æ–ª–Ω–µ–Ω–∏–π
row_count_add = ws_add.max_row

# –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–µ–∫—É—â–∏–µ –¥–∞–Ω–Ω—ã–µ –∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ü–µ–ª–µ–≤–æ–≥–æ —Ñ–∞–π–ª–∞ –Ω–∞—á–∏–Ω–∞—è —Å 3-–π —Å—Ç—Ä–æ–∫–∏
rows_data = []
for row in ws_target.iter_rows(min_row=3, max_row=ws_target.max_row):
    row_data = []
    for cell in row:
        if isinstance(cell, Cell):  # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ —è—á–µ–π–∫–∞ –Ω–µ –æ–±—ä–µ–¥–∏–Ω—ë–Ω–Ω–∞—è
            cell_data = {
                "value": cell.value,
                "font": copy.copy(cell.font),
                "alignment": copy.copy(cell.alignment),
                "fill": copy.copy(cell.fill),
                "border": copy.copy(cell.border),
                "protection": copy.copy(cell.protection),
            }
            row_data.append(cell_data)
        else:
            row_data.append(None)  # –î–ª—è –æ–±—ä–µ–¥–∏–Ω—ë–Ω–Ω—ã—Ö —è—á–µ–µ–∫ –¥–æ–±–∞–≤–ª—è–µ–º None
    rows_data.append(row_data)

# –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ç–µ–∫—É—â–∏—Ö –æ–±—ä–µ–¥–∏–Ω—ë–Ω–Ω—ã—Ö –¥–∏–∞–ø–∞–∑–æ–Ω–∞—Ö
merged_ranges = list(ws_target.merged_cells.ranges)

# –†–∞–∑—ä–µ–¥–∏–Ω—è–µ–º —è—á–µ–π–∫–∏, –µ—Å–ª–∏ –æ–Ω–∏ –ø–µ—Ä–µ—Å–µ–∫–∞—é—Ç—Å—è —Å –¥–∏–∞–ø–∞–∑–æ–Ω–æ–º –≤—Å—Ç–∞–≤–∫–∏
merged_cells_to_remove = []
for merged_range in merged_ranges:
    min_row, max_row = merged_range.min_row, merged_range.max_row
    if min_row >= 3:
        merged_cells_to_remove.append(merged_range)

for merged_range in merged_cells_to_remove:
    ws_target.unmerge_cells(str(merged_range))

# –í—Å—Ç–∞–≤–ª—è–µ–º –ø—É—Å—Ç—ã–µ —Å—Ç—Ä–æ–∫–∏ –≤ —Ü–µ–ª–µ–≤–æ–π —Ñ–∞–π–ª, –Ω–∞—á–∏–Ω–∞—è —Å 3-–π —Å—Ç—Ä–æ–∫–∏
ws_target.insert_rows(idx=3, amount=row_count_add)

# –í—Å—Ç–∞–≤–ª—è–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ –Ω–æ–≤—ã–µ –ø–æ–∑–∏—Ü–∏–∏
for row_idx, row_data in enumerate(rows_data, start=3 + row_count_add):
    for col_idx, cell_data in enumerate(row_data, start=1):
        target_cell = ws_target.cell(row=row_idx, column=col_idx)
        if cell_data is not None:
            target_cell.value = cell_data["value"]
            target_cell.font = cell_data["font"]
            target_cell.alignment = cell_data["alignment"]
            target_cell.fill = cell_data["fill"]
            target_cell.border = cell_data["border"]
            target_cell.protection = cell_data["protection"]

# –ö–æ–ø–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ –∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–∑ —Ñ–∞–π–ª–∞ –¥–æ–ø–æ–ª–Ω–µ–Ω–∏–π –≤ —Ü–µ–ª–µ–≤–æ–π —Ñ–∞–π–ª
for row_idx, row in enumerate(ws_add.iter_rows(min_row=1, max_row=row_count_add, values_only=False), start=3):
    for col_idx, cell in enumerate(row, start=1):
        target_cell = ws_target.cell(row=row_idx, column=col_idx)
        if isinstance(cell, Cell):  # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ —è—á–µ–π–∫–∞ –Ω–µ –æ–±—ä–µ–¥–∏–Ω—ë–Ω–Ω–∞—è
            target_cell.value = cell.value
            target_cell.font = copy.copy(cell.font)
            target_cell.alignment = copy.copy(cell.alignment)
            target_cell.fill = copy.copy(cell.fill)
            target_cell.border = copy.copy(cell.border)
            target_cell.protection = copy.copy(cell.protection)

# –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –æ–±—ä–µ–¥–∏–Ω—ë–Ω–Ω—ã–µ —è—á–µ–π–∫–∏
for merged_range in merged_ranges:
    # –£—á–∏—Ç—ã–≤–∞–µ–º –≤–æ–∑–º–æ–∂–Ω–æ–µ —Å–º–µ—â–µ–Ω–∏–µ —Å—Ç—Ä–æ–∫
    if merged_range.min_row >= 3:
        new_start_row = merged_range.min_row + row_count_add
        new_end_row = merged_range.max_row + row_count_add
        ws_target.merge_cells(start_row=new_start_row, start_column=merged_range.min_col,
                              end_row=new_end_row, end_column=merged_range.max_col)

# –£–¥–∞–ª—è–µ–º —á–µ—Ç–≤–µ—Ä—Ç—ã–π —Å—Ç–æ–ª–±–µ—Ü —Å –¥–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç–∞–º–∏
ws_target.delete_cols(4)

# –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ —Ü–µ–ª–µ–≤–æ–º —Ñ–∞–π–ª–µ
wb_target.save(target_file_path)

# –í—ã–≤–æ–¥ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –≤—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã—Ö —Å—Ç—Ä–æ–∫ –≤ –ª–æ–≥
with open(log_file_path, 'r+') as f:
    content = f.read()
    f.seek(0)
    f.write(f"{datetime.now().strftime('%Y-%m-%d %H:%M')} - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã—Ö —Å—Ç—Ä–æ–∫: {row_count_add}\n" + content)    

# –ò—Å–ø–æ–ª—å–∑—É–µ–º xlwings –¥–ª—è –ø–µ—Ä–µ—Å—á–µ—Ç–∞ —Ñ–æ—Ä–º—É–ª
app = xw.App(visible=False)
wb = xw.Book(target_file_path)
wb.app.calculate()
wb.save()
wb.close()
app.quit()
# –ó–∞–ø–∏—Å—ã–≤–∞–µ–º –ª–æ–≥ –≤ —Ñ–∞–π–ª
with open(log_file_path, 'r+') as f:
    content = f.read()
    f.seek(0)
    f.write(f"{datetime.now().strftime('%Y-%m-%d %H:%M')} - –§–æ—Ä–º—É–ª—ã –ø–µ—Ä–µ—Å—á–∏—Ç–∞–Ω—ã\n" + content)    
