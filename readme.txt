Имеем директорию, в которую раз в сутки из БД HCL Domino выгружаются данные по сотрудникам в формате .csv.
Скрипт парсера hundler.py выбирает файл .csv с последней датой изменения и преобразует его в файл .xlsx заданного формата.
Сортировка данных осуществляется сначала по департаменту сотрудника, затем по должности, для чего использован словарь весов title_weights.
Для чтения .csv файла вместо функции pandas read_csv используется построчное считывание оператором with as, это позволяет принудительно загрузить в массив все строки исходного файла, которые функция read_csv посчитала некорректными.
Кроме автоматической выгрузки БД была необходимость внести в справочник дополнительные номера телефонов отсутствующие в базе, для этого использовал файл дополнений Дополнения.xlsx, который добавляется к целевому файлу справочника в начало списка.
К имени сотрудника добавляется ссылка для отправки E-mail по клику.