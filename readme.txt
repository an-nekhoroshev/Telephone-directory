Имеем директорию, в которую раз в сутки выгружается БД телефонного справочника в формате .csv.
Скрипт парсера hundler_git.py выбирает файл с последней датой изменения и преобразует его в файл .xlsx заданного формата.
Сортировка данных осуществляется сначала по департаменту сотрудника, затем по должности, для чего использован словарь весов title_weights.
Для чтения .csv файла вместо функции pandas read_csv используется построчное считывание оператором with as, это позволяет принудительно загрузить в массив все строки исходного файла, которые функция read_csv посчитала некорректными и отказывалась загружать.
Кроме автоматической выгрузки БД была необходимость внести в справочник дополнительные номера телефонов отсутствующие в базе, для этого использовал файл дополнений Additions.xlsx, который добавляется к целевому файлу справочника в начало списка.
Для примера приложены несколько строк исходного файла .csv и результат обработки данных в .xlsx